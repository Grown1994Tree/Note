#磁盘

### 一、使用命令行查找出还未挂载的磁盘

1. 获取可用块设备的信息 `lsblk` 
2. 获取文件系统对应的信息 `lsblk -f`
所显示的数据中如果没有挂载点，则该磁盘是还未挂载的，所以可以进行挂载操作。
![avatar](/Linux/磁盘/磁盘信息.png)

### 二、如何挂载新硬盘
1. 先在虚拟机上添加新的虚拟硬盘,再启动虚拟机
![avatar](/Linux/磁盘/添加虚拟硬盘.png)
2. 使用 `lsblk` 命令行查看硬盘信息,确认硬盘是否已经添加
![avatar](/Linux/磁盘/新硬盘.png)
3. 使用 `fdisk` 对添加的设备进行分区
在linux中，一切都是文件，因此所有新添加的硬盘也会以文件的形式展现出来。
通过第2步我们知道，硬盘名称为sdb,所以我们可以在 `dev` 目录中找到 `sdb`目录。<font size=2>`dev` 目录通常都是存放设备文件及信息</font>

这样，我们就可以使用 `fdisk /dev/sdb` 对该硬盘进行分区。详细操作见下图。
![avatar](/Linux/磁盘/创建分区.png)
创建的两个分区已经体现出来。
![avatar](/Linux/磁盘/分区.png)

4. 使用 `mkfs` 对硬盘进行格式化
 - 正常来说，厂家提供的硬盘都是初级格式化，因此还需要进一步格式化以形成文件系统，这样操作系统就可以对该硬盘分区进行操作了。
 - 因为还未格式化，所以系统还没有提供唯一标识符
![avatar](/Linux/磁盘/格式化之前.png)
 - 使用 `mkfs -t [文件系统类型] 分区` 指令对分区进行格式化。格式化后，我们可以看到系统已经提供了唯一标识符。
![avatar](/Linux/磁盘/格式化.png)
![avatar](/Linux/磁盘/格式化之后.png)

5. 使用 `mount` 把硬盘挂载到对应的目录。
 - `mount [设备路径] [挂载路径]`
![avatar](/Linux/磁盘/挂载示例.png)
![avatar](/Linux/磁盘/挂载.png)
![avatar](/Linux/磁盘/挂载完成.png)
*<font size=2>通常我们会使用`umount [分区|目录]` 对硬盘进行卸载</font>*

6. 修改fstab文件确保可以永久挂载
到第5点已经可以把一个硬盘给挂载到目录里面，但这是暂时的。如果要永久挂载，需要修改fstab文件
- fstab文件位于/etc目录下,且为只读文件 `cd /etc`
- 要先把该文件改为可读写文件后进行编辑
`chmod 7777 fstab`  //修改为宽度写文件
`vim fstab`  //编辑fstab文件,详细内容如下所示

![avatar](/Linux/磁盘/修改fstab文件.png）

###三、 磁盘情况查询
1. 使用 `df -h` 指令查看分区的使用率。*<font size=2>通常，一个分区使用律达到80%以上就要考虑清理磁盘</font>*
![avatar](/Linux/磁盘/目录信息.png)

2. 使用 `du -h` 指令查看文件和目录的使用状况
![avatar](/Linux/磁盘/文件和目录使用率.png)

###四、统计
1. 使用 `ls -l /homes | grep '^-' | wc -l` 指令统计目录及文件的总数
![avatar](/Linux/磁盘/文件数.png)

2. 使用 `tree` 
   - 系统不一定已经安装该程序，所以需要先安装，然后才使用
   - 使用 `tree [目录名]` 指令进行处理