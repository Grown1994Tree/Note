# 觅思文档开源版部署

### 一、下载地址
使用git进行下载到本地：`git clone https://gitee.com/zmister/MrDoc`

### 二、安装基础环境
1. 安装python3:
    - 下载安装版本：`wget https://www.python.org/ftp/python/3.8.10/Python-3.8.10.tgz`
    - 解压安装包：`tar -zxvf Python-3.8.10.tgz` *<font size=2>tgz后缀等同于tar.gz</font>*
    - 安装依赖：`yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel`
    - 进入安装目录进行安装：
    ```
        #进入安装目录
        cd Python-3.8.10

        #安装
        ./configure --prefix=/usr/local/ #/usr/local/为安装目录
        make
        make install

    ```

2. 安装第三方库：
    - 进入MrDoc目录，使用 `pip3 install -r requirements.txt`指令安装第三方库。*<font size=2>第三方库放在requirements.txt</font>*
    - 安装mysqlclient驱动：
        - 安装依赖：
        ubuntu:`sudo apt-get install python3-dev default-libmysqlclient-dev build-essential`
        centOs:`sudo yum install python3-devel mysql-devel`
        - 安装驱动：`pip3 install mysqlclient`

### 三、配置数据库和初始化数据库
1. 修改`MrDoc/config/config.ini`文件
```
    [site]
    # True表示开启站点调试模式，False表示关闭站点调试模式
    debug = False

    [database]
    # engine，指定数据库类型，接受sqlite、mysql、oracle、postgresql
    # engine = sqlite
    # name表示数据库的名称
    # name = db_name
    # user表示数据库用户名
    # user = db_user
    # password表示数据库用户密码
    # password = db_pwd
    # host表示数据库主机地址
    # host = db_host
    # port表示数据库端口
    # port = db_port
    # 因为使用mywql,所以配置为mysql
    engine = mysql
    name = MRDoc
    user = root
    password = 123456
    host = 127.0.0.1
    port = 3306

    [locale]
    # 默认站点语言为 中文简体，如需使用其他语言，请配置 language 参数；
    # 默认站点时区为 Asia/Shanghai，如需使用其他时区，请配置 timezone 参数

    [selenium]
    # 在Windows环境下测试或使用，请配置driver = Chrome
    # driver = Chrome
    # 如果系统无法正确安装或识别chromedriver，请指定chromedriver在计算机上的绝对路径
    # driver_path = driver_path
```
2. 创建数据库
3. 生成数据库
```
    python3 manage.py makemigrations
    python3 manage.py migrate
```

4. 创建管理员用户
    `python3 manage.py createsuperuser`

### 四、运行
 1. 测试
    `python3 manage.py runserver [host:port]` *<font size=2>使用django自带的服务端</font>*
 2. 线上
    `uswgi --ini uswgi配置文件`

### 五、安装遇到的问题
pip3 install --upgrade pip

pip3 install setuptools-scm