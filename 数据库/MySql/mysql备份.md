# mysql备份

### 一、数据库备份策略
   1. 完全备份
        - 备份整个数据库，较为浪费空间，不适合每天都进行备份。
        - 通常第一次备份使用完全备份，后面的备份改为用差异备份或者增量备份。
        - 还原数据库较为简单。
   2. 部分备份 *<font size=2>分为增量备份和差异备份</font>*
        - 增量备份
            - 只备份跟上一次完全备份有差异的数据，使用空间较小。
            - 还原数据库时比较复杂。
        - 差异备份
            - 只备份跟第一次完全备份的数据有差异的部分，使用空间相对增量备份较多。
            - 还原数据库比增量备份较为简单。

### 二、数据库备份方式和内容

   1. 数据库的运行状态
        - 热备份，不影响对数据库的读写。
        - 温备份，不影响对数据库的读。
        - 冷备份，会影响对数据库的读写。
   2. 数据的备份方式
        - 物理备份，通常使用`cp`或`tar`等指令对数据文件进行复制或压缩。
        - 逻辑备份，通常使用`mysqldump`指令导出数据到其他目录。
   3. 备份内容主要为数据、日志、存储过程、函数以及服务器配置文件。

### 三、 使用cp、tar指令进行物理备份
   1. 备份时停止mysql服务
   2. 复制或打包 `var/lib/mysql` 目录下的所有文件到备份目录 *<font size=2>复制时要保证权限不被改变</font>*


### 四、 使用mysqldump指令进行逻辑备份。 
   1. 备份语句
      - `mysqldump [选项] 数据库 [表名]` 对数据库的某些表格进行备份，如果表名没有填写，则是备份该库的所有表格。*<font size=2>通常使用`>`重定向到其他文件</font>*
      ![avatar](/SQL/MySql/mysqldump备份.png)   
      
      - `mysqldump [选项] --databases 数据库 [数据库...]` 对选择的库进行整库备份

      - `mysqldump [选项] --all-databases [选项]` 对所有库进行整库备份

    2. 还原语句
      - `mysql -u root 数据库 < [备份文件]` 把备份文件导入到对应的数据库当中.

      - `source [备份文件]` 登陆mysql后，使用该语句进行还原。